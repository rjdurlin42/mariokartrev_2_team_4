Team 4 – Mario Kart & Ride Replay Simulator

Team Members: Ray Durlin, Blake Pickett, Tyler Chittum, Benjamin Reed, and Sage Mooneyham
<br /><br />

**Experimentation**
<br /><br />
**Resistance Subsystem**
<br />
| Item                            | Testing Criteria                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Testing Method                                                                                                                                                              | Measure of Success (MOS)                                                                               | MOS Met? | What is needed for Improvement?                                                                                                                                                                                                                                 |
|---------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Magnet Distance Range           | A distance range of 2-25mm from magnet to flywheel was selected, as these distances matched up well with the torque values that we want the resistance system to apply.                                                                                                                                                                                                                                                                                                                                                                                                        | Operate the linear actuator and measure the distance between the flywheel and magnets to ensure that a distance of 2 mm and 25 mm can be achieved                           | Operate the linear motor at a distance between 2 mm to 25 mm                                           | Yes      | Replace the linear actuator hub with a hub that will not move. Original hub that used screwed to tighten to the actuator shaft was not received                                                                                                                 |
| Minimum Tire Speed              | The minimum speed of the bike tire shall be considered 116.35 rpm. This value is based on the American Council on Exercise's recommendation for the minimum speed required for moderate exercise on a bike [2]. This correlates to 2501.52 rpm in the flywheel. At speeds less than 116.35 rpm, the torque placed on the rider will not be specified to reach any minimum value, and the resulution of the resistance changes within this operating region is not specified.                                                                                                   | Rotate the flywheel 2501 rpm to ensure that the magnets will be at it's furthest distance from the flywheel, thus not applying a specified torque or resistance to the user | Pedal the bike with a contonious 116.35 bike tire RPM                                                  | Yes      | Minimum tire speed was achieved. After experimentation, it was found that the minimum tire speed should be decreased for optimum torque range                                                                                                                   |
| Maximum Tire Speed              | The maximum speed of the bike tire shall be considered 288 rpm, a value that comes from the average pedaling rpm (118 rpm) of an elite level cyclist [3] (Wheel to pedal gear ratio = 2.444, so wheel speed = 2.444*pedal speed). This correlates to 6192 rpm in the flywheel due to the the rotational velocity ratio of 43:2 between the flywheel and the wheel. If the user passes this speed, no additional torque will be applied to avoid injury to rider.                                                                                                               | Rotate the flywheel 6192 rpm to ensure that the magnets will be at it's furthest distance from the flywheel, thus not applying a any torque or resistance to the user       | Pedal the bike with a contonious 288 bike tire RPM                                                     | No       | Due to the size and balance of the flywheel, only 277 bike tire RPM was achieve. Improve upon the flywheel weight balance to allow for the bike to achieve 288 RPM continously                                                                                  |
| Maximum Torque at Minimum Speed | Using the value for tire minimum speed (116.35 rpm), we know that the maximum torque at this speed will be produced when the magnets are closest (2mm). From here, you can find magnetic field felt at the flywheel using equation 2. These values can be plugged into equation 1 to give the torque at the flywheel, which can then be converted to torque at the bike wheel/pedals using the gearing ratios between the components (this is explained in more detail later in the document). Using this logic, we find that the max torque at the minimum speed is 49.23 Nm. | Rotate the flywheel 2501 rpm to ensure that the magnets are 2 mm from the the flywheel. Ensure that the torque value is 49.23 N*m is achieved                               | Pedal the bike with a contonious 116.35 bike tire RPM and apply resistance to 49.23 Nm at the flywheel | No       | Rider could not pedal the bike with more than 25 Nm of torque applied. Improvements include lowering the maximum torque required.                                                                                                                               |
| Minimum Torque at Minimum Speed | Using the above logic while setting magnet distance to the furthest value (25mm) and wheel speed to the minimum value, we find the minimum torque at minimum speed is 0.002 Nm.                                                                                                                                                                                                                                                                                                                                                                                                | Rotate the flywheel 2501 rpm to ensure that the magnets are 25 mm from the the flywheel. Ensure that the torque value is 0.002 N*m is achieved                              | Pedal the bike with a contonious 116.35 bike tire RPM and apply resistance to 0.002 Nm at the flywheel | No       | Resistance at 25 mm while pedaling at 105 RPM is approx. 12.89 Nm. Improvements include adjusting the distance of the actuator by replacing with a longer shaft actuator. At its furthest distance of 90 mm the torque at the flywheel is 0.252 Nm (at 105 RPM) |
| Maximum Torque at Maximum Speed | Using the above logic while setting magnet distance to the closest value and wheel speed to the maximum value (288 rpm), we find the maximum torque at maximum speed is 121.85 Nm. Safety always being a concern, this force is much lower than what is needed to break any leg bone in the average person                                                                                                                                                                                                                                                                     | Rotate the flywheel 6192 rpm to ensure that at a maximum torque value of 121.85 N*m is achieved                                                                             | Pedal the bike with a contonious 288 bike tire RPM and apply resistance to 121.85 Nm at the flywheel   | No       | Improve upon experimental method and flywheel weight balancing to achieve measure of success                                                                                                                                                                    |
| Minimum Torque at Maximum Speed | Using the above logic while setting magnet distance to the furthest value and wheel speed to the maximum value, we find the minimum torque at maximum speed is 0.004 N•m.                                                                                                                                                                                                                                                                                                                                                                                                      | Rotate the flywheel 6192 rpm to ensure that the minimum torque value of 0.004 N*m is achieved                                                                               | Pedal the bike with a contonious 288 bike tire RPM and apply resistance to 0.004 Nm at the flywheel    | No       | Replace the linear actuator to include a longer shaft. At its furthest position of 90 mm the torque on the flywheel is approximately 0.992 Nm                                                                                                                   |

<br /><br />

**Resistance Subsystem Data Analysis**
<br /><br />
*Data Gathered During Experiment*
<br /><br />

The bike was pedaled at a constant speed of either 105 RPM or 277 RPM of the bike tire. The magnet was positioned at a measured distance and recorded. The rider stopped 
pedaling the bike, and the time was recorded until the bike tire came to a complete stop. The acceleration was determined using the change in speed divided by the change in 
time. Using the formula torque equals mass multiplied by acceleration, the torque values were determined.

Figure 1 below represents the plot of torque values as seen by the riding using the gear ratio between the front and rear sprocket. The plots were created using the equation 
fit for each speed. The distance was limited to 0 to 60 mm as it best represented the raw data gathered. Figure 2 and 3 below represents the raw data gathered, which shows 
the smallest distance between the flywheel and the magnets that could be tested is 13 mm at 105 RPM and 14 mm at 277 RPM.

The plot validates initial experimentation that showed a lower amount of available torque at 277 RPM. This was an unexpected result and will need to be further investigated. 
Theoretically, the torque should be greater at a faster angular velocity. Possible causes for the inaccuracy are speculates that the flywheel mass or unbalancing may play a 
role in data accuracy. The root cause of the inaccuracy was not determined in this experimentation.

<br /><br />

![image](https://user-images.githubusercontent.com/114370750/235333105-b0e15f83-03c1-4b55-9f20-cfeb7b4dd683.png)
<br />
Figure 1. Torque Vs. Distance at 105 RPM and 277 RPM Based on Trendline.

<br /><br />

![image](https://user-images.githubusercontent.com/114370750/235333572-66700d25-39f6-4e13-b16d-74613aff8ce0.png)
<br />
Figure 2. Torque Vs. Distance at 105 RPM Raw Data.
<br /><br />

![image](https://user-images.githubusercontent.com/114370750/235333623-f00ef537-0e02-4db7-8999-dadd4e3cf9f9.png)
<br />
Figure 3. Torque Vs. Distance at 277 RPM Raw Data.

<br /><br />

Data Collected at 105 RPM
<br />
| Distance (mm) | Time (s) | Delta Velocity (m/s) | Acceleration (m/s^2) | Force (N) | Torque (Nm) on Tire | Torque on Pedal (N) |
|---------------|----------|----------------------|----------------------|-----------|---------------------|---------------------|
| 90            | 8.46     | 3.212                | 0.380                | 0.861     | 0.252               | 5.407               |
| 85            | 7.42     | 3.212                | 0.433                | 0.982     | 0.287               | 6.165               |
| 82            | 7.17     | 3.212                | 0.448                | 1.016     | 0.297               | 6.380               |
| 77            | 6.9      | 3.212                | 0.465                | 1.056     | 0.308               | 6.630               |
| 73            | 6.73     | 3.212                | 0.477                | 1.082     | 0.316               | 6.797               |
| 70            | 6.58     | 3.212                | 0.488                | 1.107     | 0.323               | 6.952               |
| 65            | 6.6      | 3.212                | 0.487                | 1.104     | 0.322               | 6.931               |
| 61            | 6.45     | 3.212                | 0.498                | 1.129     | 0.330               | 7.092               |
| 57            | 5.6      | 3.212                | 0.574                | 1.301     | 0.380               | 8.169               |
| 54            | 5.75     | 3.212                | 0.559                | 1.267     | 0.370               | 7.956               |
| 50            | 5.06     | 3.212                | 0.635                | 1.440     | 0.420               | 9.041               |
| 46            | 6.16     | 3.212                | 0.521                | 1.183     | 0.345               | 7.426               |
| 40            | 5.63     | 3.212                | 0.570                | 1.294     | 0.378               | 8.125               |
| 38            | 5.02     | 3.212                | 0.640                | 1.451     | 0.424               | 9.113               |
| 35            | 4.25     | 3.212                | 0.756                | 1.714     | 0.501               | 10.764              |
| 31            | 3.94     | 3.212                | 0.815                | 1.849     | 0.540               | 11.611              |
| 28            | 3.74     | 3.212                | 0.859                | 1.948     | 0.569               | 12.232              |
| 25            | 3.55     | 3.212                | 0.905                | 2.052     | 0.599               | 12.886              |
| 20            | 3.29     | 3.212                | 0.976                | 2.214     | 0.647               | 13.905              |
| 17            | 2.59     | 3.212                | 1.240                | 2.812     | 0.822               | 17.663              |
| 13            | 1.85     | 3.212                | 1.736                | 3.937     | 1.150               | 24.728              |

<br /><br />

Data Collected at 277 RPM
<br />
| Distance (mm) | Delta Time (s) | Delta Velocity (m/s) | Acceleration (m/s^2) | Force (N) | Torque (Nm) on Tire | Torque on Pedal (N) |
|---------------|----------------|----------------------|----------------------|-----------|---------------------|---------------------|
| 90            | 16.18          | 8.473                | 0.524                | 1.188     | 0.347               | 7.459               |
| 83            | 16.33          | 8.473                | 0.519                | 1.177     | 0.344               | 7.390               |
| 80            | 16             | 8.473                | 0.530                | 1.201     | 0.351               | 7.543               |
| 76            | 18             | 8.473                | 0.471                | 1.068     | 0.312               | 6.705               |
| 71            | 16.9           | 8.473                | 0.501                | 1.137     | 0.332               | 7.141               |
| 67            | 17.01          | 8.473                | 0.498                | 1.130     | 0.330               | 7.095               |
| 64            | 17.05          | 8.473                | 0.497                | 1.127     | 0.329               | 7.078               |
| 59            | 16.43          | 8.473                | 0.516                | 1.170     | 0.342               | 7.345               |
| 56            | 16.12          | 8.473                | 0.526                | 1.192     | 0.348               | 7.487               |
| 51            | 16.23          | 8.473                | 0.522                | 1.184     | 0.346               | 7.436               |
| 46            | 15.88          | 8.473                | 0.534                | 1.210     | 0.353               | 7.600               |
| 44            | 15.9           | 8.473                | 0.533                | 1.209     | 0.353               | 7.590               |
| 40            | 15             | 8.473                | 0.565                | 1.281     | 0.374               | 8.046               |
| 37            | 15.7           | 8.473                | 0.540                | 1.224     | 0.358               | 7.687               |
| 32            | 14             | 8.473                | 0.605                | 1.373     | 0.401               | 8.620               |
| 27            | 11.3           | 8.473                | 0.750                | 1.701     | 0.497               | 10.680              |
| 21            | 9.6            | 8.473                | 0.883                | 2.002     | 0.585               | 12.571              |
| 19            | 8.39           | 8.473                | 1.010                | 2.290     | 0.669               | 14.384              |
| 14            | 5.66           | 8.473                | 1.497                | 3.395     | 0.992               | 21.322              |

<br /><br />



**Linear Actuator Stand Subsystem**
<br />
| Item                  | Testing Criteria                                                                                   | Testing Method                                                     | Measure of Success (MOS)                                                                                   | MOS Met? | What is needed for Improvement?                                                                                                                                          |
|-----------------------|----------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Linear Actuator Stand | The linear actuator is secured in a manner that the actuator and stand are anchored                | Completion of repeated changes of linear actuator during operation | Actuator and stand does not move when during during operation of linear motor                              | Yes      | Replace the stand top with 1 complete sheet of acrylic to strengthen                                                                                                     |
| Linear Actuator Stand | The case of the linear actuator is grounded                                                        | Measure electrical continuity between actuator case and ground     | Presense of electrical continuity from actuator to bike stand frame                                        | Yes      | No Improvements Necessary                                                                                                                                                |
| Linear Actuator Stand | The linear actuator stand is to be sized for the motor controller to be stored inside of the stand | Visual inspection of stand and actuator controller                 | Actuator controller fits securely within the actuator stand                                                | Yes      | Replacing hook and loop attachment with 3.5 mm bolt and spacer to secure to the stand                                                                                    |
| Linear Actuator Stand | The linear actuator stand has two openings for the power and control wires                         | Visual Inspection of stand and wiring                              | Cables from actuator to controller and 12 VDC power supply cord are routed through holes within the stand  | Yes      |                                                                                                                                                                          |
| Linear Actuator Stand | The stand does not shield wireless communications of the motor controller                          | Manually send data to actuator controller wirelessly               | Actuator recieves input from main raspberry pi with no greater than 40 ms latency                          | No       | Troubleshoot and repair bluetooth code within the main raspberry pi. Motor controller does receive wireless communication from other devices such as phone via bluetooth |

<br /><br />


<br />
<br />

**Power Distribution Subsystem**
<br />
| Item           | Testing Criteria                                                                                                                                                                                                              | Testing Method                                                                                                                                                             | Measure of Success (MOS)                                                                                   | MOS Met? | What is needed for Improvement?                                                           |
|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|----------|-------------------------------------------------------------------------------------------|
| Circuit Design | Each power supply is to be adequately sized to be capable of carrying the maximum power requirement for all the devices within its respective circuit.                                                                        | Review device datasheets and system wiring schematic                                                                                                                       | All devices are able to supply power at max load per device datasheets                                     | Yes      | Replace we a power supply that has multple output voltages to increase space in enclosure |
| Circuit Design | All wire sizing is to be in accordance with National Electrical Code Article 210.19(A)(1) based on continuous circuit load [1].                                                                                               | Visually inspect all wiring powered by the power distribution system                                                                                                       | All wiring has the capacity to carry 125% of maximum continous circuit load per device datasheets          | Yes      | No Improvements Required                                                                  |
| Circuit Design | The system will maintain overprotection of the Mario Kart simulator devices with a rating of no less than %125 percent of maximum continuous circuit load as specified by the National Electrical Code Article 210.20(A) [1]. | Review device datasheets and system wiring schematic                                                                                                                       | Main circuit breaker overprotection is rated for at least 125% of maximum continous load                   | Yes      | No Improvements Required                                                                  |
| Safety         | All 120 Vac terminals within the user interface are to have been covered and contain a warning of electrocution on the cover.                                                                                                 | Visually inspect to ensure that front cover contains a warning label                                                                                                       | Front panel has warning stating that cover to remain on at any time power cord is connected                | Yes      | Replace with a high gloss label                                                           |
| Safety         | Power subsystem must include a means of de-energizing the system via circuit breaker lockout.                                                                                                                                 | Visually inspect to ensure that the power has a means to be de-energized and locked out if needed                                                                          | Power subsystem can be de-energized and locked out via electrical plug lockout                             | Yes      | No Improvements Required                                                                  |
| Safety         | Circuit to include GFCI to ensure that all devices within the Mario Kart simulation are properly protected from ground faults.                                                                                                | Test GFCI to ensure that the system contains an operating GFCI                                                                                                             | Presense of electrical continuity from the enclosure grounding bar to the ground pin of GFCI on power cord | Yes      | No Improvements Required                                                                  |
| Enclosure      | The enclosure is to be sized to house all devices within the subsystem, excluding incoming and outgoing power cabling.                                                                                                        | Visually inspect to ensure that the enclosure can contain all devices required for system operation                                                                        | All devices within the enclosure fit without interference when front panel is closed                       | Yes      | Installation of wire covers for appearances (cable trough)                                |
| Enclosure      | The front panel containing the HMI is to be removable for access.                                                                                                                                                             | Visually inspect to ensure that the front panel contains the LCD in a secure manner and the panel can be removed                                                           | Front panel is removable by user or technician                                                             | Yes      | Installation of gasket behind the LCD screen                                              |
| Enclosure      | The enclosure is to be fully enclosed and free of any openings.                                                                                                                                                               | Visually inspect to verify that the enclosure does not have any openings are gaps (excluding input and output wiring)                                                      | No gaps are present in enclosure and each hole in enclosure has a dedicated input or output wire(s)        | Yes      | Installation of 1 1/8" rubber grommet on 1 hole needed                                    |
| Enclosure      | The enclosure is to be properly grounded for protection to protect equipment and possible electrical shock.                                                                                                                   | Verify that the enclosure is properly ground to earth ground through the power cord by completing a continuity test between the linear actuator and the grounding location | Presence of electrical continuity from all grounding wires to grounding bar within enclosure               | Yes      | No Improvements Required                                                                  |

                                                                
<br /><br />


**HDMI Switcher Subsystem**
<br />
| Item                          | Testing Criteria                                                                                                                       | Testing Method                                                     | Measure of Success (MOS)                                                 | MOS Met? | What is needed for Improvement? |
|-------------------------------|----------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|--------------------------------------------------------------------------|----------|---------------------------------|
| HDMI Compatibility            | The BHS must be rated for 1080p resolutions.                                                                                           | Can assert this is met without testing (requires rating, is rated) | Has 1080p capacity                                                       | Yes      | None                            |
| HDMI Quantity                 | The switcher must have at minimum two input HDMI ports and one output HDMI port.                                                       | Can assert this is met without testing (self-evident)              | Possesses two HDMI inputs and one HDMI output                            | Yes      | None                            |
| Relay Voltage/Current Ratings | The relay coil must be rated for 3.3 V and a maximum 16 mA, and the relay must operate at 3.3 V or below.                              | No longer valid as specification                                   | No longer valid as specification                                         | No       | None                            |
| Transistor current            | The transistor may not draw more than 16 mA, and the transistor must operate with a logic signal of 3.3 V                              | Review of datasheet                                                | Can assert first by Ohm's Law; second is proven by minimal functionality | No       | None                            |
| Relay Power Rating            | The power dissipation at the relay coil cannot exceed 70 mW.                                                                           | No longer valid as specification                                   | No longer valid as specification                                         | No       | None                            |
| Back EMF Accommodations       | A diode must be implemented in parallel with the relay coil to protect the RPi from back EMF that results from de-energizing the coil  | No longer valid as specification                                   | No longer valid as specification                                         | No       | None                            |

<br /><br />

**Steering L Bracket Subsystem**
<br />
| System                       | Item                            | Testing Criteria                                                                | Testing Method                                                                                                              | Measure of Success (MOS)                                                                       | MOS Met? | What is needed for Improvement? |
|------------------------------|---------------------------------|---------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|----------|---------------------------------|
| Steering L-Bracket Subsystem | Increased Fidelity              | The Steering L-Bracket mechanism shall be strengthened using a metal component. | Visually inspect the steering sensor L-Bracket to ensure that it is composed of metal and secure                            | The L-Bracket is made of aluminum. The L-Bracket does not move when pressure is apllied to it. | Yes      | No Improvement Required         |
| Steering L-Bracket Subsystem | Adaptability to Steering Column | The L-Bracket must be positioned more than 0.25 inches off the steering column  | Measure the distance of the steering L-Bracket to the steering column and verify that the distance is more than 0.25 inches | The distance from the steering column to the L-bracket is 0.75 inches.                         | Yes      | No Improvement Required         |


<br /><br />

**Wireless Sensors Subsystem**
<br />


| Item                                                | Testing Criteria                                                                         | Testing Method                                                                                                                                                    | Measure of Success (MOS)                                                                                                                                                                                                                                                                                                                                                                                             | MOS Met? | What is needed for Improvement?                                                                                                                                                                                                                                                                                                                              |
|-----------------------------------------------------|------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Run Time                                            | Two weeks runtime with 4 hours continuous use each day                                   | Verify that battery run time is efficient for two weeks with 4 hours a day of continous use by sampling power consumed while the system is in use and is inactive | Calculations confirm that the battery pack provides sufficient power. The steering sensor subsystem uses 3902.44 mW for 2 weeks of runtime while in constant use for 4 hours a day. The speed sensor subsystem uses 15292.71 mW for 2 weeks of runtime while in constant use for 4 hours a day. Each four AA battery pack provides 21000 mW, which is sufficient to meet the power requiremnets for each subsystem.  | Yes      | The Arduino Nano 33 BLE for the speed sensor subsystem broke during testing. Replace the broken Arduino Nano 33 BLE in the speed sensor subsystem with the new one to make the subsystem bluetooth.                                                                                                                                                          |
| Speed Sensor (Missing MOSFET-Specific Requirements) | Obstacle sensor module provided with 20 mA @ 3.3 V - 5 V during operation                | Complete game test: Measure the current at the Obstacle sensor to verfiy that the Obstacle sensor receives 20 mA @ 3.3 V- 5 V during operation                    | While the obstacle sensor is in operation, the current is 24 mA when the obstacle sensor is given 3.391 V.                                                                                                                                                                                                                                                                                                           | Yes      | Replace the tape on the tire with paint or design a new way to measure the speed.                                                                                                                                                                                                                                                                            |
| Speed Sensor (Missing MOSFET-Specific Requirements) | Arduino Nano 33 BLE provided with DC voltage between 5 V and 21 V                        | Complete game test: Measure voltage at the Arduino Nano 33 BLE to verify that the Arduino Nano 33 BLE receives a voltage between 5 VDC and 21 VDC                 | With new batteries, the battery pack supplies more than 7 V to the Arduino Nano 33 BLE.                                                                                                                                                                                                                                                                                                                              | Yes      |                                                                                                                                                                                                                                                                                                                                                              |
| Speed Sensor (Missing MOSFET-Specific Requirements) | Current through the 3.3 V output pin on the Arduino Nano 33 BLE must be less than 100 mA | Complete game test: Measure and verify that the current through the 3.3 V GPIO pin is less than 100 mA while in use                                               | The current on the 3.3 V GPIO pin is 24 mA which is less than 100 mA.                                                                                                                                                                                                                                                                                                                                                | Yes      |                                                                                                                                                                                                                                                                                                                                                              |
| Steering Sensor                                     | Potentiometer voltage same as ADC                                                        | Measure and verify that the voltage at the potentiometer is equal to the voltage at the ADC                                                                       | The voltage on the potentiometer is 3.285 V which is the same as the voltage ADC which is 3.285 V.                                                                                                                                                                                                                                                                                                                   | Yes      | Design a means to prevent the handlebar from turning 360 degrees. The potentiometer is not designed to turn 360 degrees. After the handle bar is turned past the potentiometer's limit, the potentiometer will break. Select a more durable potentiometer. The potentiometer on the bike broke during testing, and the spare broke during our presentation.  |
| Steering Sensor                                     | ADC must be provided with a DC voltage between 0 - 5.5 V                                 | Measure and verify that the voltage as seen by the ADC is within 0 VDC and 5.5 VDC                                                                                | The voltage at the ADC is 3.285 V which is in between 0 VDC and 5.5 VDC.                                                                                                                                                                                                                                                                                                                                             | Yes      |                                                                                                                                                                                                                                                                                                                                                              |
| Steering Sensor                                     | Current through every individual GPIO pin below 15 mA                                    | Complete game test: Measure and verify that the current through each GPIO pin used in the system is below 15 mA                                                   | The current going through the GPIO pin is 4 mA which is less than 15 mA.                                                                                                                                                                                                                                                                                                                                             | Yes      |                                                                                                                                                                                                                                                                                                                                                              |
| Data Transfer                                       | Wireless communication between sensors and main RPi for all sensors                      | Complete game test: Verify that there is communication between the main controller (RPI) and both speed sensor and steering sensor                                | Multiple races were played with wireless communication between the steering sensor (speed sensor radio chip was damaged before testing)                                                                                                                                                                                                                                                                              | No       | Wireless communication of the speed sensor still needs to be implemented.                                                                                                                                                                                                                                                                                    |
| Data Transfer                                       | Maximum latency: 40 ms                                                                   | Complete game test: Verify that the latency is less than 40 ms while the system is in normal operation                                                            | Using a stopwatch, the average latency was found to be much greater than 40 ms                                                                                                                                                                                                                                                                                                                                       | No       | The latency needs to be lowered significantly, perhaps with faster/more powerful hardware (RPi/Nano) or stronger Bluetooth signal.                                                                                                                                                                                                                           |


<br /><br />
**Wireless Subsystem Data Analysis**
<br /><br />
*Latency Analysis*
<br /><br />
Latency values were gathered using a stopwatch, starting time at a handlebar press/steering change, and stopping time when that action occured in game. From the below numbers, we can see that the steering sensor Bluetooth latency has greatly surpassed the expected value of 40 ms. I believe that the reason for this is the amount of software overhead that is involved in sending and receiving this data, as well as the interactions that must be performed with the Nintendo Switch through the joycontrol library. When performing the calculation for the expected latency, I did not incorporate this overhead. We can also see that the handlebar data has a lower latency than the ADS convertor data. I believe this is due to the fact that the handlebar data gathering process is simpler (GPIO Pin), has less software overhead in sending and converting this value, and also is a much smaller packet than the steering data due to its data type (Boolean value vs float value).
| Steering Latency (cs) | Handlebars Latency(cs) |
|-----------------------|------------------------|
| 82                    | 44                     |
| 63                    | 60                     |
| 59                    | 69                     |
| 58                    | 65                     |
| 64                    | 59                     |
| 48                    | 75                     |
| 46                    | 68                     |
| 67                    | 66                     |
| 66                    | 51                     |
| 78                    | 60                     |
| 64                    | 45                     |
| 85                    | 53                     |
| 78                    | 50                     |
| 69                    | 56                     |
| 89                    | 63                     |
| 85                    | 69                     |
| 87                    | 69                     |
| 87                    | 46                     |
| 65                    | 60                     |
| 64                    | 46                     |
| 70                    | 40                     |
| 75                    | 60                     |
| 73                    | 39                     |
| 78                    | 46                     |
| 62                    | 57                     |
| 60                    | 51                     |
| 67                    | 50                     |
| 80                    | 50                     |
| 89                    | 65                     |
| 75                    | 48                     |
| 79                    | 50                     |
| 66                    | 43                     |
| 65                    | 48                     |
| 74                    | 45                     |
| 69                    | 52                     |
| 74                    | 42                     |
| 66                    | 51                     |
| 61                    | 55                     |
| 74                    | 64                     |
| 55                    | 45                     |
| 55                    | 64                     |
| 75                    | 46                     |
| 55                    | 54                     |
| 45                    | 42                     |
| 59                    | 54                     |
| 59                    | 52                     |
| 77                    | 60                     |
| 60                    | 46                     |
| 64                    | 51                     |
| 56                    | 69                     |
| Average(ms): 680.42   | Average(ms): 540.26    |

<br /><br />
*Power Consumption Analysis*
<br />
<br />

*Speed Sensor Subsystem (4 hours a day of constant use for two weeks (56 hours))*

| Voltage (V) | Current (mA) | Power (mW) | Power use in 1 Game | Time (minutes) | Power used in 1 minute  | Power used in 56 hours |
|-------------|--------------|------------|---------------------|----------------|-------------------------|------------------------|
| 7.22        | 11           | 79.42      | 0                   | 0              | 0                       | 0                      |
| 6.78        | 11           | 74.58      | 4.84                | 4.09           | 1.183374083             | 3976.136919            |
| 6.75        | 11           | 74.25      | 0.33                | 3.05           | 0.108196721             | 363.5409836            |
| 6.75        | 10           | 67.5       | 6.75                | 3.3            | 2.045454545             | 6872.727273            |

<br />

*Speed Sensor Subsystem (Time while not in constant use (280 hours))*

| Voltage (V) | Current (mA) | Power (mW) | Power use in 1 Test | Time (minutes) | Power used in 1 minute  | Power used in 280 Hours |
|-------------|--------------|------------|---------------------|----------------|-------------------------|-------------------------|
| 7.11        | 11           | 78.21      | 0                   | 0              | 0                       | 0                       |
| 6.67        | 11           | 73.37      | 4.84                | 20             | 0.242                   | 4065.6                  |
| 6.54        | 11           | 71.94      | 1.43                | 20             | 0.0715                  | 1201.2                  |
| 6.31        | 11           | 69.41      | 2.53                | 20             | 0.1265                  | 2125.2                  |

<br />

*Steering Sensor Subsystem (4 hours a day of constant use for two weeks (56 hours))*

| Voltage (V) | Current (mA) | Power (mW) | Power use in 1 Game | Time (minutes) | Power used in 1 minute  | Power used in 56 hours |
|-------------|--------------|------------|---------------------|----------------|-------------------------|------------------------|
| 6.408       | 24           | 153.792    | 0                   | 0              | 0                       | 0                      |
| 6.332       | 24           | 151.968    | 1.824               | 4.09           | 0.44596577              | 1498.444988            |
| 6.32        | 24           | 151.68     | 0.288               | 3.05           | 0.09442623              | 317.2721311            |
| 6.25        | 24           | 150        | 1.68                | 3.3            | 0.509090909             | 1710.545455            |

<br />

*Steering Sensor Subsystem (Time while not in constant use (280 hours))*

| Voltage (V) | Current (mA) | Power (mW) | Power use in 1 Test | Time (minutes) | Power used in 1 minute  | Power used in 280 Hours |
|-------------|--------------|------------|---------------------|----------------|-------------------------|-------------------------|
| 6.62        | 24           | 158.88     | 0                   | 0              | 0                       | 0                       |
| 6.55        | 24           | 157.2      | 1.68                | 20             | 0.084                   | 1411.2                  |
| 6.49        | 24           | 155.76     | 1.44                | 20             | 0.072                   | 1209.6                  |
| 6.4         | 24           | 153.6      | 2.16                | 20             | 0.108                   | 1814.4                  |

<br /><br />


**RRSA Subsystem**
<br />
| Item             | Testing Criteria                                                                                      | Testing Method                                                                                                                                                                                 | Measure of Success (MOS)                                    | MOS Met? | What is needed for Improvement?                                                                                                                                                                                                                                                                                 |
|------------------|-------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Sensors          | Altitude recording must have +/- 4.67 cm precision                                                    | Start recording; move box upward 30 cm; show difference in start pressure and end pressure corresponds to 30 cm +/- 4.67 cm                                                                    | Altitude precision with +/-4.67 cm                          | No       | More precision required                                                                                                                                                                                                                                                                                         |
| Sensors          | Video quality: at least 720p @ 30 fps                                                                 | Can assert this is met without testing                                                                                                                                                         | Quality of video is greater than 720p @ 30 fps              | Yes      |                                                                                                                                                                                                                                                                                                                 |
| Sensors          | Synchronous recording                                                                                 | Trigger a change in the recorded value of a sensor at some point in the recording; compare index of occurence with timestamp of video frame at which change is induced; repeat for each sensor | Recording is synchronous without any lose of data           | No       | A more accurate method of taking measurements at set points in time may be needed. Also, the video sometimes drops small portions of the frames. If this could be detected in code, it would be good to delete datapoints from the time ranges of dropped frames. Preventing the dropped frames would be ideal. |
| Sensors          | Sample rate > 9.6 Hz                                                                                  | Compare number of datapoints to recording time                                                                                                                                                 | Sampling rate is at least 9.6 Hz (Nyquist Rate)             | Yes      |                                                                                                                                                                                                                                                                                                                 |
| Camera Recording | Capture 3 hours of continuous data in one recording (evaluates both battery life and SD card storage) | Record continuously for three hours                                                                                                                                                            | Data recorded for at least 3 hours with conintous operation | Yes      |                                                                                                                                                                                                                                                                                                                 |
| Enclosure        | Protected from outdoor weather conditions and vibration                                               | Spray it down in the sink, ride over gravel and up onto and down from sidewalks with it attached                                                                                               | Devices within the enclosure have no presence of moisture   | No       | Water resistance works, but mounting bracket broke; needs stronger bracket or more centered mounting                                                                                                                                                                                                            |
| Battery Charging | Visual indication of battery charge status                                                            | Can assert this is met without testing                                                                                                                                                         | Charging light is visible                                   | Yes      |                                                                                                                                                                                                                                                                                                                 |
| Mounting         | Mountable on a standard mountain bike with no obstructions to video                                   | Record video with it mounted, ensure full frame visible                                                                                                                                        | RRSA module is mounted and does not obstruct view of rider  | Yes      |

<br /><br />

**Resistance Controller Subsystem**
<br />

| Item                     | Testing Criteria                                                                                                                                              | Testing Method                                                                                                                                                                          | Measure of Success (MOS)                       | MOS Met? | What is needed for Improvement?                                                                                                                                                |
|--------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Actuator Duty Cycle      | 25%                                                                                                                                                           |                                                                                                                                                                                         |                                                | Yes      |                                                                                                                                                                                |
| Actuator Driving Voltage | +/- 12 V +/- 1 %, assuming power supply provides 12 V                                                                                                         | Test with oscilloscope under the following: extending, retracting                                                                                                                       | Actuator voltage is 12 VDC +/- 1%              | Yes      | Technically met, as voltage ripple is induced purely by power supply, but this ripple could be attenuated by a capacitor on the supply. Note that doing so would be pointless. |
| Current Capability       | 7 A                                                                                                                                                           | Test with 7 A DC load to ensure no overload for: extending, retracting                                                                                                                  | No overload at 7 A                             | No       | Can't test - would need 7 A electronic load                                                                                                                                    |
| Wireless Communications  | Data rate: > 100 Baud                                                                                                                                         | Configured to 9600 Baud - can assert without testing                                                                                                                                    | Data rate is greater than 100 Baud             | Yes      |                                                                                                                                                                                |
| Back-EMF Protection      | Transistor body diode Vf < 1 V                                                                                                                                | Test for all transistors: extension, retraction                                                                                                                                         | Vf is lest then 1 V                            | Yes      |                                                                                                                                                                                |
| Mountability             | The PCB layout must account for the need to mount the circuit within its housing, as such, screw holes shall be included in the PCB design.                   | Can assert this is met without testing                                                                                                                                                  | PCB is mountable                               | Yes      |                                                                                                                                                                                |
| Stability                | The device must operate without becoming unstable.                                                                                                            | Test for maximum extension, maximum retraction, middle point, movement by increments of 200 points, 100 points, 50 points, 25 points, 15 points. Ensure absence of undamped oscillation | Device operates stable within testing criteria | Yes      |                                                                                                                                                                                |
| Resolution               | The controller must be capable of monitoring and responding to even the smallest changes in actuator extension correpsponding to a change in resistance state | Redundant to main 85 states MOS                                                                                                                                                         | Actuator reaches 85 unique states              | No       |

<br /><br />

**Addition System Wide Measures of Success**
<br />

| Item                     | Testing Criteria                                                                                                        | Testing Method                                                                                                                                                       | Measure of Success (MOS)                                                                                                                     | MOS Met? | What is needed for Improvement?                                                                            |
|--------------------------|-------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|----------|------------------------------------------------------------------------------------------------------------|
| Mario Kart Exercise Bike | Resistance changes from: being hit by shell, using mushroom, riding offroad, and going over a boost pad                 | Complete game test: Verify that when user is playing Mario Kart that resistance felt varies when using mushroom, riding offroad, and going over a boost pad          | Appropriate resistance values are felt in response to gameplay events                                                                        | No       | Determine how to access the rumble data within a Python program and place it into an array that is useable |
| Mario Kart Exercise Bike | Ride resistance reset to nominal value after completion of a course                                                     | Complete game test: Verify that the resistance resets to nominal value after user completes course                                                                   | Resets to minimal value after ride is complete                                                                                               | Yes      | No Improvements Required                                                                                   |
| Mario Kart Exercise Bike | Steering mechanism sturdiness improved                                                                                  | Complete game test:  Ensure that the steering mechanisms remain secure prior to, during, and after user plays Mario Kart.                                            | The aluminum L-Bracket is sturdier than the plastic 3D printed L-Bracket. The conduct hanger ensures the steering mechanism remains secure.  | Yes      | Enclose all of the steering system equipment.                                                              |
| Mario Kart Exercise Bike | Wiring and devices enclosed and secured                                                                                 | Visual inspection of devices and wiring                                                                                                                              | All wiring components are enclosed and wiring is secure to stationary object                                                                 | Yes      | Installation of cable protection for wires outsite of the enclosure                                        |
| Mario Kart Exercise Bike | Warning on LCD screen for playing durtion 1 hour or greater                                                             | Complete game test: Verify that that warning message displays on LCD after 1 hour of countinous game play                                                            | Warning message pops up after an hour of gameplay                                                                                            | Yes      | Design to start up pop-up counter with beginning of GUI MET clock.                                         |
| Ride Simulation System   | Ride resistance to within 10 % of calculated resistance when operating within limits of system                          | Completed test ride: Connect RRSA Module to bike and measure results to ensure resistance values calculated by the module is within 10% of the limits of the system  | Accuracy of ride resistance within 10% of actual                                                                                             | No       |                                                                                                            |
| Ride Simulation System   | Can collect the following synchronously: barometric pressure, video, bike wheel speed and record to non-volatile memory | Completed test ride: Verify that during a bike ride that the barometric pressure, video, and bike wheel speed are record to non-volatile memory                      | RRSA capture  the barometric pressure, video, and bike wheel speed are record to non-volatile memory                                         | No       |                                                                                                            |
| Ride Simulation System   | Filter collected ride data to below 1 Hz, with frequencies greater than 1 Hz attenuated by 80 dB                        | Completed test ride: Verify that the ride data collected is filtered below 1 Hz with frequencies greater than 1 Hz attenuated by 80 dB during bike ride              | Ride data is filted below 1 Hz                                                                                                               | No       |                                                                                                            |
| Ride Simulation System   | Rider elevation is recorded (and displayed?) to within 5 % of published elevation                                       | Completed test ride:  Verify that bike rider elevation is captured during bike ride is within 5% of published elevation                                              | Rider elevation collected is within 5% of published elevation                                                                                | No       |                                                                                                            |
| Both                     | Main controller does not crash or overheat under normal operating condition (70 F +/- 5 F)                              | Completed test ride: Operate the Mario Kart and RRSA for at least 1 hour continously without main controller crashing or operating outside of normal characteristics | Main controller ran for over 1 hour without any incidents of crashing or overheating experienced                                             | No       |                                                                                                            |
| Both                     | Resistance system supply voltage does not exceed 30 V                                                                   | Measure each device's power into to ensure that the supplied for voltage does not exceed 30 V to all DC components                                                   | All device supply voltages are less than 30V                                                                                                 | Yes      | No Improvements Required                                                                                   |
| Both                     | Resistance system has at least 85 distinct states                                                                       | Cycle through resistance system levels to verify that at least 85 different states are achieved                                                                      | 85 distinct states were not found                                                                                                            | No       | A more precise actuator is needed                                                                          |

<br /><br />

